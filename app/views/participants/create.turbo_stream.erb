<%= turbo_stream.append "participants-list" do %>
  <%= render "participants/participant", participant: @participant %>
<% end %>

<%= turbo_stream.replace "participant_form" do %>
  <%= render "participants/form", event: @event, participant: Participant.new %>
<% end %>

<%= turbo_stream.update "participant-count" do %>
  <%= @event.participants.count %>
<% end %>

<%= turbo_stream.update "participant-warning" do %>
  <% participants_count = @event.participants.count %>
  <% if participants_count < 3 %>
    <div class="bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded-lg mb-6">
      ⚠️ You need at least 3 participants to start the Secret Santa.
    </div>
  <% end %>
<% end %>

<%= turbo_stream.update "draw-actions" do %>
  <% participants_count = @event.participants.count %>
  <% if @event.assignments_drawn? %>
    <div class="bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg mb-4">
      ✓ Assignments have been drawn! Participants can now view their assigned person.
    </div>
    <%= button_to "Reshuffle Assignments", draw_assignments_event_path(@event), method: :post, class: "w-full bg-yellow-600 hover:bg-yellow-700 text-white font-semibold py-4 px-6 rounded-lg transition-colors", data: { turbo_confirm: "This will create new assignments for everyone. Continue?" } %>
  <% elsif participants_count >= 3 %>
    <%= button_to "Draw Names & Send Invitations", draw_assignments_event_path(@event), method: :post, class: "w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-4 px-6 rounded-lg transition-colors" %>
  <% else %>
    <button disabled class="w-full bg-gray-300 text-gray-500 font-semibold py-4 px-6 rounded-lg cursor-not-allowed">
      Add at least <%= 3 - participants_count %> more participant<%= 's' if (3 - participants_count) != 1 %>
    </button>
  <% end %>
<% end %>
